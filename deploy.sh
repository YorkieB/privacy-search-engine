#!/bin/bash\n\n# DigitalOcean Deployment Script for Privacy Search Engine\n# Run this script on your DigitalOcean droplet\n\nset -e\n\necho \"ðŸš€ Starting deployment of Privacy Search Engine...\"\n\n# Update system packages\necho \"ðŸ“¦ Updating system packages...\"\nsudo apt update\nsudo apt upgrade -y\n\n# Install Docker if not already installed\nif ! command -v docker &> /dev/null; then\n    echo \"ðŸ³ Installing Docker...\"\n    curl -fsSL https://get.docker.com -o get-docker.sh\n    sudo sh get-docker.sh\n    sudo usermod -aG docker $USER\n    rm get-docker.sh\nfi\n\n# Install Docker Compose if not already installed\nif ! command -v docker-compose &> /dev/null; then\n    echo \"ðŸ”§ Installing Docker Compose...\"\n    sudo curl -L \"https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n    sudo chmod +x /usr/local/bin/docker-compose\nfi\n\n# Install Node.js and npm if needed for local development\nif ! command -v node &> /dev/null; then\n    echo \"ðŸ“¦ Installing Node.js...\"\n    curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -\n    sudo apt-get install -y nodejs\nfi\n\n# Create application directory\nAPP_DIR=\"/opt/privacy-search\"\necho \"ðŸ“ Setting up application directory at $APP_DIR...\"\nsudo mkdir -p $APP_DIR\nsudo chown $USER:$USER $APP_DIR\n\n# Clone or update repository (assuming you'll upload files)\ncd $APP_DIR\n\n# Create .env file template\necho \"ðŸ“ Creating environment file...\"\ncat > .env << EOL\n# Environment Configuration\nNODE_ENV=production\nPORT=3001\n\n# Brave Search API\nBRAVE_API_KEY=your_brave_api_key_here\n\n# Security\nALLOWED_ORIGIN=*\nEOL\n\necho \"âš™ï¸ Environment file created. Please update .env with your actual Brave API key:\"\necho \"   nano .env\"\necho \"\"\necho \"ðŸ”‘ Your current Brave API key: BSAq4NtSqFFWRcGdfgz5V8VfvcH_rkc\"\necho \"\"\nread -p \"Press Enter after updating the .env file to continue...\"\n\n# Build and start the application\necho \"ðŸ—ï¸ Building and starting the application...\"\ndocker-compose up --build -d\n\n# Wait for application to start\necho \"â³ Waiting for application to start...\"\nsleep 30\n\n# Test the application\necho \"ðŸ§ª Testing the application...\"\nif curl -f http://localhost:3001/health; then\n    echo \"\"\n    echo \"âœ… Application is running successfully!\"\n    echo \"\"\n    echo \"ðŸŒ Your Privacy Search Engine is available at:\"\n    echo \"   http://$(curl -s ifconfig.me):3001\"\n    echo \"\"\n    echo \"ðŸ“Š To view logs: docker-compose logs -f\"\n    echo \"ðŸ”„ To restart: docker-compose restart\"\n    echo \"ðŸ›‘ To stop: docker-compose down\"\nelse\n    echo \"âŒ Application health check failed. Check logs:\"\n    docker-compose logs privacy-search\nfi\n\necho \"ðŸŽ‰ Deployment complete!\"